<?xml version="1.0" encoding="UTF-8"?>

<itemizer>

<!--docunent blocks (starttext, startsection...)-->	
	
	<recipe name="context.structural.startsections">
	
		<class>ESXMLItem</class>
		<start-selector>context.structural.start-section:capture(name)</start-selector>
		<end-selector>context.structural.stop-section</end-selector>
		<subrecipes>	
			<include-root-recipes />
		</subrecipes>
		
	</recipe>
	
	<recipe name="context.structural.sections">
	
		<class>ESXMLItem</class>
		<selector>context.structural.section:capture(itemizer-firstused) + balanced.brace:capture(name)</selector>
		
	</recipe>
	
<!-- [] -->
<!-- MacRabbit told me that it is currently not possible to have code folding and no entry in the Navigator - this here makes no sense in the Navigator (would fill it completely up): -->	
	<!--<recipe name="context.container.codeblock">

		<start-selector>context.openbracket.level0</start-selector>
		<end-selector>context.closebracket.level0</end-selector>
		
	</recipe>-->
	
<!--floats-->
	<recipe name="context.float">
		<class>ESXMLItem</class>
		<selector>context.float:capture(name)</selector>
	</recipe>

<!--Metafun code block-->		 
	<recipe name="context.container.metafun-code-block">
	
		<class>ESCodeClassItem</class>
		<start-selector>context.support.function.start.metafun:capture(name)</start-selector>
		<end-selector>context.support.function.stop.metafun</end-selector>
		<subrecipes>
			<include recipe="context.container.environment"/>
			<include-root-recipes />
		</subrecipes>
	
	</recipe>
	
<!--Lua code block-->		 
	<recipe name="context.container.lua-code-block">
	
		<class>ESCodeClassItem</class>
		<start-selector>context.support.function.start.lua:capture(name)</start-selector>
		<end-selector>context.support.function.stop.lua</end-selector>
		<subrecipes>
			<include recipe="context.container.environment"/>
			<include-root-recipes />
		</subrecipes>
	
	</recipe>
	
	<recipe name="context.container.lua-code-block-single-liner">
		<class>ESCodeClassItem</class>
		<selector>context.support.function.general.lua:capture(name)</selector>
	</recipe>
<!--\start... \stop...-->		 
	<recipe name="context.container.environment">
	
		<class>ESXMLItem</class>
		<start-selector>context.support.function.start.environment:capture(name)</start-selector>
		<end-selector>context.support.function.stop.environment</end-selector>
		<subrecipes>
			<include recipe="context.container.environment"/>
			<include-root-recipes />
		</subrecipes>
	
	</recipe>


	<recipe name="context.container.startstop">
	
		<class>ESXMLItem</class>
		<start-selector>language-root.context > support.function.start.environment:capture(name)</start-selector>
		<end-selector>language-root.context > support.function.stop.environment</end-selector>
		<subrecipes>	
			<include-root-recipes />
		</subrecipes>
	
	</recipe>
	
	
<!--control block-->
	<recipe name="context.container.control.if">
		<class>ESJSControlBlockItem</class>
		<selector>context.keyword.control.if:capture(name)</selector>
	</recipe>
	
<!--metapost control block-->	
	<recipe name="metapost.container.control.for">
		<class>ESJSControlBlockItem</class>
		<start-selector>metafun.keyword.control[text='for']:capture(itemizer-firstused) + *:capture(open-parameters) ~ metafun.keyword.control[text=':']:capture(close-parameters)</start-selector>
		<end-selector>metafun.keyword.control[text='endfor']</end-selector>
		<subrecipes>
			<include recipe="metapost.container.control.for"/>
		</subrecipes>
	</recipe>
<!--metapost macro def-->
	<recipe name="metapost.container.function">
		<start-selector>metafun.storage.definition.begin:capture(itemizer-firstused) + *:capture(name)</start-selector>
		<end-selector>metafun.storage.definition.end</end-selector>
		<subrecipes>
			<include recipe="metapost.container.control.for"/>
		</subrecipes>
	</recipe>
<!--comment-->
	<recipe name="context.comment">
		<class>ESCommentItem</class>
		<selector>comment.line</selector>
	</recipe>
	
<!--define/def...-->	
	<recipe name="context.container.support.function">
		<selector>context.support.function.define > support.function.name:capture(name)</selector>
	</recipe>
	
	
</itemizer>


