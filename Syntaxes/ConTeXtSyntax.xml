<?xml version="1.0" encoding="UTF-8"?>

<syntax name="language-root.context">

    <zones>
        <include collection="Define"/>
        <include collection="Default_Order_of_Zones"/>
    </zones>
    
    <library>
    
		<collection name="Default_Order_of_Zones">
        	<include collection="Lua"/>
        	<include collection="Metafun"/>
        	<include syntax="language-root.tex" /><!--TeX syntax-->
        	<include collection="Environments"/>
            <include collection="Sectioning"/>
            <include collection="BalancedBraces"/>
        	<include collection="BalancedBrackets"/>
        	<include collection="BalancedParenthesis"/>
            <include collection="Math"/>
            <include collection="Keywords"/>
            <include collection="General"/>
            <include collection="Escapecharacter"/>
        </collection>
        
        <collection name="BalancedBraces">
            <zone name="context.balanced.brace">
                <starts-with>
                    <expression>\{</expression>
                    <capture number="0" name="context.open-brace.level0"/>
                </starts-with>
                <ends-with>
                    <expression>\}</expression>
                    <capture number="0" name="context.close-brace.level0"/>
                </ends-with>
                <subzones>
        			<include collection="BalancedBraces_array"/>
                    <include collection="Between_Braces"/>
                </subzones>
            </zone>
        </collection>
        
        <collection name="Between_Braces">
            <include collection="Define"/>
			<include collection="Lua"/>
			<include collection="Metafun"/>
			<include collection="Environments"/>
			<include collection="Keywords"/>
			<include collection="Default_Order_of_Zones"/>
        </collection>
        
        <collection name="BalancedBraces_array">
            <zone name="context.delimiter.balanced.brace-level1">
                <starts-with>
                    <expression>\{</expression>
                    <capture number="0" name="context.openbrace.level1"/>
                </starts-with>
                <ends-with>
                    <expression>\}</expression>
                    <capture number="0" name="context.closebrace.level1"/>
                </ends-with>
                <subzones>
                    <zone name="context.delimiter.balanced.brace-level2">
                        <starts-with>
                            <expression>\{</expression>
                            <capture number="0" name="context.openbrace.level2"/>
                        </starts-with>
                        <ends-with>
                            <expression>\}</expression>
                            <capture number="0" name="context.closebrace.level2"/>
                        </ends-with>
                        <subzones>
                            <zone name="context.delimiter.balanced.brace-level3">
                                <starts-with>
                                    <expression>\{</expression>
                                    <capture number="0" name="context.openbrace.level3"/>
                                </starts-with>
                                <ends-with>
                                    <expression>\}</expression>
                                    <capture number="0" name="context.closebrace.level3"/>
                                </ends-with>
                                <subzones>
                                    <zone name="context.delimiter.balanced.brace-level4">
                                        <starts-with>
                                            <expression>\{</expression>
                                            <capture number="0" name="context.openbrace.level4"/>
                                        </starts-with>
                                        <ends-with>
                                            <expression>\}</expression>
                                            <capture number="0" name="context.closebrace.level4"/>
                                        </ends-with>
                                        <subzones>
                                            <zone name="context.delimiter.balanced.brace-level5">
                                                <starts-with>
                                                    <expression>\{</expression>
                                                    <capture number="0" name="context.openbrace.level5"/>
                                                </starts-with>
                                                <ends-with>
                                                    <expression>\}</expression>
                                                    <capture number="0" name="context.closebrace.level5"/>
                                                </ends-with>
                                                <subzones>
                                                    <zone name="context.delimiter.balanced.brace-level6">
                                                        <starts-with>
                                                            <expression>\{</expression>
                                                            <capture number="0" name="context.openbrace.level6"/>
                                                        </starts-with>
                                                        <ends-with>
                                                            <expression>\}</expression>
                                                            <capture number="0" name="context.closebrace.level6"/>
                                                        </ends-with>
                                                        <subzones>
                                                            <zone name="context.delimiter.balanced.brace-level7">
                                                                <starts-with>
                                                                    <expression>\{</expression>
                                                                    <capture number="0" name="context.openbrace.level7"/>
                                                                </starts-with>
                                                                <ends-with>
                                                                    <expression>\}</expression>
                                                                    <capture number="0" name="context.closebrace.level7"/>
                                                                </ends-with>
                                                                <subzones>
                                                                    <zone name="context.delimiter.balanced.brace-level8">
                                                                        <starts-with>
                                                                            <expression>\{</expression>
                                                                            <capture number="0" name="context.openbrace.level8"/>
                                                                        </starts-with>
                                                                        <ends-with>
                                                                            <expression>\}</expression>
                                                                            <capture number="0" name="context.closebrace.level8"/>
                                                                        </ends-with>
                                                                        <subzones>
                                                                            <include collection="Between_Braces"/>
                                                                        </subzones>
                                                                    </zone>
                                                                    <include collection="Between_Braces"/>
                                                                </subzones>
                                                            </zone>
                                                            <include collection="Between_Braces"/>
                                                        </subzones>
                                                    </zone>
                                                    <include collection="Between_Braces"/>
                                                </subzones>
                                            </zone>
                                            <include collection="Between_Braces"/>
                                        </subzones>
                                    </zone>
                                    <include collection="Between_Braces"/>
                                </subzones>
                            </zone>
                            <include collection="Between_Braces"/>
                        </subzones>
                    </zone>
                    <include collection="Between_Braces"/>
                </subzones>
            </zone>
        </collection>
                
        <collection name="BalancedBrackets">
            <zone name="context.balanced.bracket">
                <starts-with>
                    <expression>(\\[A-Za-z@!?:_]*[A-Za-z@!?:_])\s*(\[)|^\s*(\[)|(?&lt;=\]|\})\s*(\[)</expression>
                    <capture number="1" name="context.support.function.general"/>
                    <capture number="2" name="context.open-bracket.level0"/>
                    <capture number="3" name="context.open-bracket.level0"/>
                    <capture number="4" name="context.open-bracket.level0"/>
                </starts-with>
                <ends-with>
                    <expression>\]</expression>
                    <capture number="0" name="context.close-bracket.level0"/>
                </ends-with>
                <subzones name="context.between.brackets">
                	<!--for ConTeXt tables:-->
                	<zone name="context.keyword.other.table">
                	    <expression>\|</expression>
                	</zone>
                    <include collection="Between_Brackets"/>
                </subzones>
            </zone>
        </collection>
        
        <collection name="BalancedParenthesis">
            <zone name="context.balanced.parenthesis">
                <starts-with>
                    <expression>(\\(?:num|dim|glue|mue)expr)\s*(\()</expression>
                    <capture number="1" name="context.support.function.general"/>
                    <capture number="2" name="context.close-parenthesis.level0"/>
                </starts-with>
                <ends-with>
                    <expression>\)</expression>
                    <capture number="0" name="context.close-parenthesis.level0"/>
                </ends-with>
                <subzones name="context.between.parentheses">
					<include collection="BalancedParenthesis_array"/>
                    <include collection="Between_Braces"/>
                </subzones>
            </zone>
        </collection>        
                
        <collection name="BalancedParenthesis_array">
               <zone name="context.delimiter.balanced.parenthesis-level1">
                   <starts-with>
                       <expression>\(</expression>
                       <capture number="0" name="context.openparenthesis.level1"/>
                   </starts-with>
                   <ends-with>
                       <expression>\)</expression>
                       <capture number="0" name="context.closeparenthesis.level1"/>
                   </ends-with>
                   <subzones name="context.between.parentheses">
                       <zone name="context.delimiter.balanced.parenthesis-level2">
                           <starts-with>
                               <expression>\(</expression>
                               <capture number="0" name="context.openparenthesis.level2"/>
                           </starts-with>
                           <ends-with>
                               <expression>\)</expression>
                               <capture number="0" name="context.closeparenthesis.level2"/>
                           </ends-with>
                           <subzones name="context.between.parentheses">
                               <zone name="context.delimiter.balanced.parenthesis-level3">
                                   <starts-with>
                                       <expression>\(</expression>
                                       <capture number="0" name="context.openparenthesis.level3"/>
                                   </starts-with>
                                   <ends-with>
                                       <expression>\)</expression>
                                       <capture number="0" name="context.closeparenthesis.level3"/>
                                   </ends-with>
                                   <subzones name="context.between.parentheses">
                                       <zone name="context.delimiter.balanced.parenthesis-level4">
                                           <starts-with>
                                               <expression>\(</expression>
                                               <capture number="0" name="context.openparenthesis.level4"/>
                                           </starts-with>
                                           <ends-with>
                                               <expression>\)</expression>
                                               <capture number="0" name="context.closeparenthesis.level4"/>
                                           </ends-with>
                                           <subzones name="context.between.parentheses">
                                               <zone name="context.delimiter.balanced.parenthesis-level5">
                                                   <starts-with>
                                                       <expression>\(</expression>
                                                       <capture number="0" name="context.openparenthesis.level5"/>
                                                   </starts-with>
                                                   <ends-with>
                                                       <expression>\)</expression>
                                                       <capture number="0" name="context.closeparenthesis.level5"/>
                                                   </ends-with>
                                                   <subzones name="context.between.parentheses">
                                                       <zone name="context.delimiter.balanced.parenthesis-level6">
                                                           <starts-with>
                                                               <expression>\(</expression>
                                                               <capture number="0" name="context.openparenthesis.level6"/>
                                                           </starts-with>
                                                           <ends-with>
                                                               <expression>\)</expression>
                                                               <capture number="0" name="context.closeparenthesis.level6"/>
                                                           </ends-with>
                                                           <subzones name="context.between.parentheses">
                                                               <zone name="context.delimiter.balanced.parenthesis-level7">
                                                                   <starts-with>
                                                                       <expression>\(</expression>
                                                                       <capture number="0" name="context.openparenthesis.level7"/>
                                                                   </starts-with>
                                                                   <ends-with>
                                                                       <expression>\)</expression>
                                                                       <capture number="0" name="context.closeparenthesis.level7"/>
                                                                   </ends-with>
                                                                   <subzones name="context.between.parentheses">
                                                                       <zone name="context.delimiter.balanced.parenthesis-level8">
                                                                           <starts-with>
                                                                               <expression>\(</expression>
                                                                               <capture number="0" name="context.openparenthesis.level8"/>
                                                                           </starts-with>
                                                                           <ends-with>
                                                                               <expression>\)</expression>
                                                                               <capture number="0" name="context.closeparenthesis.level8"/>
                                                                           </ends-with>
                                                                           <subzones name="context.between.parentheses">
                                                                               <include collection="Between_Braces"/>
                                                                           </subzones>
                                                                       </zone>
                                                                       <include collection="Between_Braces"/>
                                                                   </subzones>
                                                               </zone>
                                                               <include collection="Between_Braces"/>
                                                           </subzones>
                                                       </zone>
                                                       <include collection="Between_Braces"/>
                                                   </subzones>
                                               </zone>
                                               <include collection="Between_Braces"/>
                                           </subzones>
                                       </zone>
                                       <include collection="Between_Braces"/>
                                   </subzones>
                               </zone>
                               <include collection="Between_Braces"/>
                           </subzones>
                       </zone>
                       <include collection="Between_Braces"/>
                   </subzones>
               </zone>
        </collection>
        
        <collection name="Between_Brackets">
            <include collection="Define"/>
            <include collection="Lua"/>
            <include collection="Metafun"/>
            <include collection="Keys"/>
            <include collection="Keywords"/>
            <include collection="Default_Order_of_Zones"/>
        </collection>
        
        <collection name="Escapecharacter">
            <zone name="context.escape.character">
                <expression>\\[^0-9a-zA-Z@?!\[\]\(\)]</expression>
            </zone>
        </collection>
        
        <!--<collection name="Csname">
            <zone name="context.container.support.function.csname">
                <starts-with>
                    <expression>\\csname\b</expression>
                    <capture number="0" name="context.support.function.general.csname"/>
                </starts-with>
                <ends-with>
                    <expression>\\endcsname\b</expression>
                    <capture number="0" name="context.support.function.general.csname"/>
                </ends-with>
                <subzones name="context.support.function.name.subzone">
                    <include collection="DefinedVariable"/>
                </subzones>
            </zone>
        </collection>-->
        
        <collection name="Define">
            <!--[A-Za-z@!?:_;,\.] instead of the usual [A-Za-z@!?:_] because there exists \; and \. and they can theoretically be redefined-->
            <zone name="context.function.define">
            	<starts-with>
            		<expression>(\\define)\s*(?:(\[)(\d+)(\]))\s*(\\[[:alpha:]_@!?:_]*[[:alpha:]_@!?:_;,\.])\s*((?:\#+[[:alpha:]_@!?:1-9]+)+)?\s*(\[)</expression>
            		<capture number="1" name="context.support.function.general.def"/>
            		<capture number="2" name="context.open-bracket.level0"/>
            		<capture number="3" name="context.support.variable.define"/>
            		<capture number="4" name="context.close-bracket.level0"/>
            		<capture number="5" name="context.support.function.name"/>
            		<capture number="6" name="context.support.variable.define"/>
            		<capture number="7" name="context.open-bracket.level0"/>
            	</starts-with>
            	<ends-with>
            		<expression>\]</expression>
            		<capture number="0" name="context.close-bracket.level0"/>
            	</ends-with>
            	<subzones name="context.def-subzone">
            	    <include collection="Between_Brackets"/>
            	</subzones>
            </zone>
            
            <zone name="context.function.define">
            	<starts-with>
            		<expression>(\\(?:g|e|x)?def)\s*(\\[[:alpha:]_@!?:]*[[:alpha:]_@!?:;,\.])\s*((?:\#+[[:alpha:]_@!?:1-9]+)+)?\s*(\[)</expression>
            		<capture number="1" name="context.support.function.general.def"/>
            		<capture number="2" name="context.support.function.name"/>
            		<capture number="3" name="context.support.variable.define"/>
            		<capture number="4" name="context.open-bracket.level0"/>
            	</starts-with>
            	<ends-with>
            		<expression>\]</expression>
            		<capture number="0" name="context.close-bracket.level0"/>
            	</ends-with>
            	<subzones name="context.def-subzone">
            	    <include collection="Between_Brackets"/>
            	</subzones>
            </zone>
            
            <zone name="context.function.define">
				<expression>(\\define)\s*(?:(\[)(\d+)(\]))\s*(\\[[:alpha:]_@!?:]*[[:alpha:]_@!?:;,\.])</expression>
				<capture number="1" name="context.support.function.general.def"/>
				<capture number="2" name="context.open-bracket.level0"/>
				<capture number="3" name="context.support.variable.define"/>
				<capture number="4" name="context.close-bracket.level0"/>
				<capture number="5" name="context.support.function.name"/>
            </zone>
            
            <zone name="context.support.function.new">
                <expression>\\new(?:if|conditional|every|counter|signal|box|count|dimen|fam|insert|language|muskip|read|skip|toks|write)\b\s*(\\[[:alpha:]_@!?:]*[[:alpha:]_@!?:])?</expression>
                <capture number="1" name="context.support.function.name"/>
            </zone>
            
        </collection>
        
        <collection name="TableCells">
            <zone name="context.container.table-cell">
                <starts-with>
                    <expression>\\(?:b(TD|TC|TH))\b</expression>
                    <capture number="0" name="context.support.function.table.cell.begin"/>
                </starts-with>
                <ends-with>
                    <expression>\\(e(\1))\b</expression>
                    <capture number="0" name="context.support.function.table.cell.end"/>
                </ends-with>
                <subzones>
                    <include collection="Default_Order_of_Zones"/>
                </subzones>
            </zone>
        </collection>
        
         <collection name="TableRows">
         
            <zone name="context.support.function.table.row.end">
                <expression>\\(HL|TB|NR|SR|FR|MR|LR|AR)\b</expression>
            </zone>
            
            <zone name="context.support.function.table.cell.begin">
                <expression>\\(NC|VL|NC|VL)\b</expression>
            </zone>
            
            <zone name="context.container.table-row">
            <starts-with>
                    <expression>\\bTR\b</expression>
                    <capture number="0" name="context.support.function.table.row.begin"/>
            </starts-with>
            <ends-with>
                    <expression>\\eTR\b</expression>
                    <capture number="0" name="context.support.function.table.row.end"/>
            </ends-with>
                <subzones>
                    <include collection="TableCells"/>
                </subzones>
            </zone>
            
        </collection>
        
        <collection name="Environments">
			
			<zone  name="context.balanced.structural.float">
			    <starts-with>
			        <expression>(\\(?:place|complete)[0-9A-Za-z_@!?:]+)\s*(\[)</expression>
			        <capture number="1" name="context.support.function.place-complete"/>
			        <capture number="2" name="context.open-bracket.level0"/>
			    </starts-with>
			    <ends-with>
			        <expression>\]</expression>
			        <capture number="0" name="context.close-bracket.level0"/>
			    </ends-with>
			    <subzones name="context.between.brackets">
			        <include collection="Between_Brackets"/>
			    </subzones>
			</zone>
			
            <zone name="context.structural.float">
                    <expression>\\(place|complete)[0-9A-Za-z_@!?:]+</expression>
                    <capture number="0" name="context.support.function.place-complete"/>
            </zone>
            
            <!--table-->
            <zone name="context.container.table.float">
            	<starts-with>
            		<expression>(?:\\bTABLE(head|foot|body|next)?)\b</expression>
            		<capture number="0" name="context.support.function.start-table"/>
            	</starts-with>
            	<ends-with>
            		<expression>\\eTABLE\1</expression>
            		<capture number="0" name="context.support.function.stop-table"/>
            	</ends-with>
            	<subzones>
            		<include collection="Define"/>
            		<include collection="TableRows"/>
            		<include collection="Default_Order_of_Zones"/>
            	</subzones>
            </zone>
            <zone name="context.container.table.float">
            	<starts-with>
            		<expression>(?:\\start(TABLE|table(head|tail)?|tabulate|linetable))\b</expression>
            		<capture number="0" name="context.support.function.start-table"/>
            	</starts-with>
            	<ends-with>
            		<expression>\\stop\1</expression>
            		<capture number="0" name="context.support.function.stop-table"/>
            	</ends-with>
            	<subzones>
            		<include collection="Define"/>
            		<include collection="TableRows"/>
            		<include collection="Default_Order_of_Zones"/>
            	</subzones>
            </zone>

			<zone name="context.support.function.start-protect">
				<expression>\\unprotect\b</expression>
			</zone>
			<zone name="context.support.function.stop-protect">
				<expression>\\protect\b</expression>
			</zone>

        </collection>
                
        <collection name="Lua">
        
            <zone name="context.container.language-root.lua">
                <starts-with>
                    <expression>(?:\\start((lua)(code|parameterset)|usercode))\b</expression>
                    <capture number="0" name="context.support.function.start.lua"/>
                </starts-with>
                <ends-with>
                    <expression>\\stop\1\b</expression>
                    <capture number="0" name="context.support.function.stop.lua"/>
                </ends-with>
                <subzones>
                	<include collection="Default_Order_of_Zones"/>
                </subzones>
            </zone>
            
            <zone name="context.container.language-root.lua">
                <starts-with>
                    <expression>((?:\\(?:ctx|direct|late)lua|\\ctxsprint|(?:luaescapestring))|\\ctxcommand|\\usercode)\s*(\{)</expression>
                    <capture number="1" name="context.support.function.general.special-lua"/>
                    <capture number="2" name="context.open-brace.level0"/>
                </starts-with>
                <ends-with>
                    <expression>\}</expression>
                    <capture number="0" name="context.close-brace.level0"/>
                </ends-with>
                <subzones>
                	<include collection="Default_Order_of_Zones"/>
                </subzones>
            </zone>
            
        </collection>
        
        <collection name="Metafun">
            <zone name="context.container.language-root.metafun">
                <starts-with>
                    <expression>(\\start(unique|reusable|use|static)?MP)(code|inclusions|extensions|initializations|definitions|drawing|run|clip|(position)?graphic|environment|page|figure)\b</expression>
                    <capture number="0" name="context.support.function.start.metafun"/>
                </starts-with>
                <ends-with>
                    <expression>\\stop\2MP\3\b</expression>
                    <capture number="0" name="context.support.function.stop.metafun"/>
                </ends-with>
                <subzones>
                    <include collection="Default_Order_of_Zones"/>
                </subzones>
            </zone>
        </collection>
        
        <collection name="Math">
        
			<zone name="context.math.textstyle">
				<starts-with>
					<expression>(\\(?:mathematics|inlinemath|math|inlinemathematics))\s*(\{)</expression>
					<capture number="1" name="context.support.function.begin.math"/>
					<capture number="2" name="context.open-brace.level0"/>
				</starts-with>
			<ends-with>
				<expression>\}</expression>
				<capture number="0" name="context.close-brace.level0"/>
			</ends-with>
				<subzones>
					<include collection="Between_Math" />
					<include collection="Default_Order_of_Zones"/>
				</subzones>
			</zone>
			
			<zone name="context.math.displaystyle">
				<starts-with>
					<expression>(\\(?:displaymath|displaymathematics|automathematics))\s*(\{)</expression>
					<capture number="1" name="context.support.function.begin.math"/>
					<capture number="2" name="context.open-brace.level0"/>
				</starts-with>
			<ends-with>
				<expression>\}</expression>
				<capture number="0" name="context.close-brace.level0"/>
			</ends-with>
				<subzones>
					<include collection="Between_Math" />
					<include collection="Default_Order_of_Zones"/>
				</subzones>
			</zone>
			
			<zone name="context.math.displaystyle">
				<starts-with>
					<expression>\\startformula</expression>
					<capture number="0" name="context.support.function.begin.math"/>
				</starts-with>
			<ends-with>
				<expression>\\stopformula</expression>
				<capture number="0" name="context.support.function.end.math"/>
			</ends-with>
				<subzones>
					<include collection="Between_Math" />
					<include collection="Default_Order_of_Zones"/>
				</subzones>
			</zone>
			
			<!--TeX style math-->
			<zone name="tex.math.displaystyle">
			    <starts-with>
			        <expression>\$\$</expression>
			        <capture number="0" name="tex.begin.math"/>
			    </starts-with>
			    <ends-with>
			        <expression>\$\$</expression>
			        <capture number="0" name="tex.end.math"/>
			    </ends-with>
			    <subzones name="tex.math-subzone">
			    	<include collection="Between_Math" />
			        <include syntax="language-root.context"/>
			    </subzones>
			</zone>
			
			<zone name="tex.math.textstyle">
			    <starts-with>
			        <expression>\$(?!\$)</expression>
			        <capture number="0" name="tex.begin.math"/>
			    </starts-with>
			    <ends-with>
			        <expression>\$(?!\$)</expression>
			        <capture number="0" name="tex.end.math"/>
			    </ends-with>
			    <subzones name="tex.math-subzone">
			    	<include collection="Between_Math" />
			        <include syntax="language-root.context"/>
			    </subzones>
			</zone>
        	
        </collection>
        
        <collection name="Between_Math">
        	<zone name="context.escape.character.dollar">
        	    <expression>\\\$</expression>
        	</zone>
        </collection>
        
        <collection name="Keys">
            <zone>
				<expression>(\\?)(s!|c!|v!|\?\?(?:\?\?)?|@@)?([0-9A-Za-z_@!?:]+)\s*(=)</expression>
				<capture number="1" name="context.support.key-name"/>
				<capture number="2" name="context.support.key-name.scratchvariable"/>
				<capture number="3" name="context.support.key-name"/>
				<capture number="4" name="punctuation.operator.assignment"/>
            </zone>
        </collection>
        
        <collection name="Sectioning">
        
            <zone name="context.structural.section">
				<expression>(\\(?:part|title|chapter|SlideTitle)|\\(?:sub)*(?:section|subject))\b</expression>
				<capture number="0" name="context.support.function.section"/>
            </zone>
            
            <zone  name="context.balanced.structural.start-section">
                <starts-with>
                    <expression>(\\start(?:text|project|product|component|part|title|chapter|SlideTitle)|\\start(?:sub)*(?:section|subject))\s*(\[)</expression>
                    <capture number="1" name="context.support.function.section"/>
                    <capture number="2" name="context.open-bracket.level0"/>
                </starts-with>
                <ends-with>
                    <expression>\]</expression>
                    <capture number="0" name="context.close-bracket.level0"/>
                </ends-with>
                <subzones name="context.between.brackets">
                    <include collection="Between_Brackets"/>
                </subzones>
            </zone>
            
            <zone name="context.structural.start-section">
            	<expression>(\\start(?:text|project|product|component|part|title|chapter|SlideTitle)|\\start(?:sub)*(?:section|subject))\b</expression>
            	<capture number="0" name="context.support.function.section"/>
            </zone>
            
            <zone name="context.structural.stop-section">
            	<expression>(\\stop(?:text|project|product|component|part|title|chapter|SlideTitle)|\\stop(?:sub)*(?:section|subject))\b</expression>
            	<capture number="0" name="context.support.function.section"/>
            </zone>
            
        </collection>
        
        <collection name="General">
        	<zone name="context.support.function.general">
        	    <expression>\\(s!|c!|v!|\?\?(?:\?\?)?|@@)?[[:alpha:]_@!?:]*[[:alpha:]_@!?:]</expression>
        	    <capture number="1" name="context.support.function.scratchvariable"/>
        	</zone>
        	<zone name="context.punctuation.delimiter.comma">
        	    <expression>,</expression>
        	</zone>
        	<zone name="context.punctuation.delimiter.colon"><!--(?!=), because of otherwise interference with MetaPost/MetaFun-->
        	    <expression>:(?!=)</expression>
        	</zone>
        </collection>
        
        <collection name="Keywords">
        
        	<zone name="context.keyword.other.spacefactorcodes">
        	    <expression>\\\?(?!\?)|\\!(?!!)|\\\.|\\,|\\:|\\;</expression>
        	</zone>
        	
        	<zone name="context.keyword.other.wordboundary">
        	    <expression>--{2,3}|\\/|\|\||\\\s|\\-|\|-\||\|/\||~|\|&lt;\||\|&gt;\|</expression>
        	</zone>
        	
            <zone name="context.keyword-other-misc">
                <starts-with>
                    <expression>(?&lt;=[^\w])(sa|at|scaled|mo|mu)((?=[\d#\\\*])|\s(?=[\d#\\\*]))</expression>
                    <capture number="1" name="context.keyword.other.misc"/>
                </starts-with>
                <ends-with>
                    <expression>(\*)|(?=[\s,\]])\b</expression>
                    <capture number="1" name="context.keyword.other.misc"/>
                </ends-with>
                <subzones>
                	<include collection="Default_Order_of_Zones"/>
                </subzones>
            </zone>
            
            <zone name="context.keyword-other-misc">
                <expression>(\d+)\s*(\*)\s*(broad|small|medium|big|hang|line|halfline|formula)|((\\s!)?(spec|name|file):)\b</expression>
                <capture number="1" name="context.numeric"/>
                <capture number="2" name="context.keyword.other.misc"/>
                <capture number="3" name="context.keyword.other.misc"/>
                <capture number="4" name="context.keyword.other.misc"/>
            </zone>
            
        </collection>
        
    </library>
    
</syntax>




