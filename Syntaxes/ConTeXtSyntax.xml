<?xml version="1.0" encoding="UTF-8"?>

<syntax name="language-root.context">

    <zones>
        <include collection="Document"/>
        <include collection="Define"/>
        <include collection="Default_Order_of_Zones"/>
    </zones>
    
    <library>
    
		<collection name="Default_Order_of_Zones">
        	<include collection="Comment"/>
        	<include collection="Lua"/>
        	<include collection="Metafun"/>
        	<include collection="Environments"/>
            <include collection="Sectioning"/>
            <include collection="If_Else"/>
            <include collection="BalancedBraces"/>
            <include collection="Group"/>
        	<include collection="BalancedBrackets"/>
        	<include collection="BalancedParenthesis"/>
            <include collection="Math"/>
            <include collection="Keywords"/>
            <include collection="Csname"/>
            <include collection="GeneralTeX"/>
            <include collection="DefinedVariable"/>
            <include collection="Escapecharacter"/>
        </collection>
                
        <collection name="BalancedBrackets">
            <zone name="context.balanced.bracket">
                <starts-with>
                	<!--has to be this verbose (commands with "place" and "start" will be used in the inspector tree), otherwise balanced brackets get not caught (this or-condition-list will grow...):-->
                    <expression>(\\[A-Za-z@!?:_]*[A-Za-z@!?:_]|(?&lt;=\\startinteractionmenu|\\starttypescriptcollection|\\starttypescript|\\startfigure|\\startgraphic|\\startintermezzo|\\starttabulate|\\starttables|\\starttable|\\startplacepairedbox|\\startplacelegend|\\startcaption|\\startplacefigure|\\startplacetable|\\startcontent|\\starthanging|\\startsectionblockenvironment|\\startfrontmatter|\\startbodymatter|\\startbackmatter|\\startappendices|SlideTitle|\\part|\\chapter|\\title|\\startsection|\\startsubsection|\\startsubsubsection|\\startsubsubsubsection|\\startsubsubsubsubsection|\\startsubsubsubsubsubsection|\\startsubsubsubsubsubsubsection|\\startsubsubsubsubsubsubsubsection|\\startsubsubsubsubsubsubsubsubsection|\\startsubsubsubsubsubsubsubsubsubsection|\\startsubsubsubsubsubsubsubsubsubsubsection|\\startsubject|\\startsubsubject|\\startsubsubsubject|\\startsubsubsubsubject|\\startsubsubsubsubsubject|\\startsubsubsubsubsubsubject|\\startsubsubsubsubsubsubsubject|\\startsubsubsubsubsubsubsubsubject|\\startsubsubsubsubsubsubsubsubsubject|\\startsubsubsubsubsubsubsubsubsubsubject|\\startsetups|\\startdescription|\\startdocument|\\startfact|\\starthiding|\\startlegend|\\startlinecorrection|\\startlines|\\startline|\\startlocal|\\startlocalenvironment|\\startmakeup|\\startnamemakeup|\\startopposite|\\startoverview|\\startpacked|\\startplacefigure|\\startplacelocalnotes|\\startbookmarks|\\startpositioning|\\startprofile|\\startsynchronization|\\startTEXpage|\\startunpacked|\\startversion|\\startlinealignment|\\startitemize|\\startitemgroup|\\startcombination|\\startcolumns|\\startcolumnset|\\startparagraph|\\startquote|\\startquotation|\\startalignment|\\startglobal|\\startlinenumbering|\\startlocalfootnotes|\\startmarginblock|\\startmarginrule|\\startnarrower|\\startoverlay|\\startproduct|\\startproject|\\startraster|\\startsymbolset|\\starttextrule|\\placefigure|\\placetable|\\placegraphic|\\placeintermezzo|\\placepairedbox|\\placepublications|\\placemargintable|\\placemarginfigure|\\startplacemargintable|\\startplacemarginfigure|\\placelistoffloats|\\placelocalnotes|\\placebookmarks))\s*(\[)|^\s*(\[)|(?&lt;=\]|\})\s*(\[)</expression>
                    <capture number="1" name="context.support.function.general"/>
                    <capture number="2" name="context.openbracket.level0"/>
                    <capture number="3" name="context.openbracket.level0"/>
                    <capture number="4" name="context.openbracket.level0"/>
                </starts-with>
                <ends-with>
                    <expression>\]</expression>
                    <capture number="0" name="context.closebracket.level0"/>
                </ends-with>
                <subzones name="context.between.brackets">
                	<!--for ConTeXt tables:-->
                	<zone name="context.keyword.other.table">
                	    <expression>\|</expression>
                	</zone>
                    <include collection="Between_Brackets"/>
                </subzones>
            </zone>
        </collection>
        
        <collection name="BalancedBraces">
            <zone name="context.balanced.brace">
                <starts-with>
                    <expression>\{</expression>
                    <capture number="0" name="context.openbrace.level0"/>
                </starts-with>
                <ends-with>
                    <expression>\}</expression>
                    <capture number="0" name="context.closebrace.level0"/>
                </ends-with>
                <subzones>
					<include collection="BalancedBraces_array"/>
					<include collection="BalancedBrackets"/>
                    <include collection="Between_Braces"/>
                </subzones>
            </zone>
        </collection>
        
        <collection name="If_Else">
        	<zone name="context.keyword.control.if">
        	    <expression>\\if[A-Za-z@!?:_]*</expression>
        	</zone>
            <zone name="context.keyword.control">
                <expression>\\fi\b|\\else\b|\\or\b</expression>
            </zone>
        </collection>
                
        <collection name="Group">
            <zone name="context.openbrace.level0">
                <expression>(\\(begin|b)group)\b</expression>
            </zone>
            <zone name="context.closebrace.level0">
                <expression>(\\(end|e)group)\b</expression>
            </zone>
        </collection>
        
        <collection name="BalancedParenthesis">
            <zone name="context.balanced.parenthesis">
                <starts-with>
                    <expression>(\\(?:num|dim|glue|mue)expr)\s*(\()</expression>
                    <capture number="1" name="context.support.function.general"/>
                    <capture number="2" name="context.closeparenthesis.level0"/>
                </starts-with>
                <ends-with>
                    <expression>\)</expression>
                    <capture number="0" name="context.closeparenthesis.level0"/>
                </ends-with>
                <subzones name="context.between.parentheses">
					<include collection="BalancedParenthesis_array"/>
                    <include collection="Between_Braces"/>
                </subzones>
            </zone>
        </collection>        
        
        <collection name="BalancedBraces_array">
            <zone name="context.delimiter.balanced.brace-level1">
                <starts-with>
                    <expression>\{</expression>
                    <capture number="0" name="context.openbrace.level1"/>
                </starts-with>
                <ends-with>
                    <expression>\}</expression>
                    <capture number="0" name="context.closebrace.level1"/>
                </ends-with>
                <subzones>
                    <zone name="context.delimiter.balanced.brace-level2">
                        <starts-with>
                            <expression>\{</expression>
                            <capture number="0" name="context.openbrace.level2"/>
                        </starts-with>
                        <ends-with>
                            <expression>\}</expression>
                            <capture number="0" name="context.closebrace.level2"/>
                        </ends-with>
                        <subzones>
                            <zone name="context.delimiter.balanced.brace-level3">
                                <starts-with>
                                    <expression>\{</expression>
                                    <capture number="0" name="context.openbrace.level3"/>
                                </starts-with>
                                <ends-with>
                                    <expression>\}</expression>
                                    <capture number="0" name="context.closebrace.level3"/>
                                </ends-with>
                                <subzones>
                                    <zone name="context.delimiter.balanced.brace-level4">
                                        <starts-with>
                                            <expression>\{</expression>
                                            <capture number="0" name="context.openbrace.level4"/>
                                        </starts-with>
                                        <ends-with>
                                            <expression>\}</expression>
                                            <capture number="0" name="context.closebrace.level4"/>
                                        </ends-with>
                                        <subzones>
                                            <zone name="context.delimiter.balanced.brace-level5">
                                                <starts-with>
                                                    <expression>\{</expression>
                                                    <capture number="0" name="context.openbrace.level5"/>
                                                </starts-with>
                                                <ends-with>
                                                    <expression>\}</expression>
                                                    <capture number="0" name="context.closebrace.level5"/>
                                                </ends-with>
                                                <subzones>
                                                    <zone name="context.delimiter.balanced.brace-level6">
                                                        <starts-with>
                                                            <expression>\{</expression>
                                                            <capture number="0" name="context.openbrace.level6"/>
                                                        </starts-with>
                                                        <ends-with>
                                                            <expression>\}</expression>
                                                            <capture number="0" name="context.closebrace.level6"/>
                                                        </ends-with>
                                                        <subzones>
                                                            <zone name="context.delimiter.balanced.brace-level7">
                                                                <starts-with>
                                                                    <expression>\{</expression>
                                                                    <capture number="0" name="context.openbrace.level7"/>
                                                                </starts-with>
                                                                <ends-with>
                                                                    <expression>\}</expression>
                                                                    <capture number="0" name="context.closebrace.level7"/>
                                                                </ends-with>
                                                                <subzones>
                                                                    <zone name="context.delimiter.balanced.brace-level8">
                                                                        <starts-with>
                                                                            <expression>\{</expression>
                                                                            <capture number="0" name="context.openbrace.level8"/>
                                                                        </starts-with>
                                                                        <ends-with>
                                                                            <expression>\}</expression>
                                                                            <capture number="0" name="context.closebrace.level8"/>
                                                                        </ends-with>
                                                                        <subzones>
                                                                            <include collection="Between_Braces"/>
                                                                        </subzones>
                                                                    </zone>
                                                                    <include collection="Between_Braces"/>
                                                                </subzones>
                                                            </zone>
                                                            <include collection="Between_Braces"/>
                                                        </subzones>
                                                    </zone>
                                                    <include collection="Between_Braces"/>
                                                </subzones>
                                            </zone>
                                            <include collection="Between_Braces"/>
                                        </subzones>
                                    </zone>
                                    <include collection="Between_Braces"/>
                                </subzones>
                            </zone>
                            <include collection="Between_Braces"/>
                        </subzones>
                    </zone>
                    <include collection="Between_Braces"/>
                </subzones>
            </zone>
        </collection>
                
        <collection name="BalancedParenthesis_array">
               <zone name="context.delimiter.balanced.parenthesis-level1">
                   <starts-with>
                       <expression>\(</expression>
                       <capture number="0" name="context.openparenthesis.level1"/>
                   </starts-with>
                   <ends-with>
                       <expression>\)</expression>
                       <capture number="0" name="context.closeparenthesis.level1"/>
                   </ends-with>
                   <subzones name="context.between.parentheses">
                       <zone name="context.delimiter.balanced.parenthesis-level2">
                           <starts-with>
                               <expression>\(</expression>
                               <capture number="0" name="context.openparenthesis.level2"/>
                           </starts-with>
                           <ends-with>
                               <expression>\)</expression>
                               <capture number="0" name="context.closeparenthesis.level2"/>
                           </ends-with>
                           <subzones name="context.between.parentheses">
                               <zone name="context.delimiter.balanced.parenthesis-level3">
                                   <starts-with>
                                       <expression>\(</expression>
                                       <capture number="0" name="context.openparenthesis.level3"/>
                                   </starts-with>
                                   <ends-with>
                                       <expression>\)</expression>
                                       <capture number="0" name="context.closeparenthesis.level3"/>
                                   </ends-with>
                                   <subzones name="context.between.parentheses">
                                       <zone name="context.delimiter.balanced.parenthesis-level4">
                                           <starts-with>
                                               <expression>\(</expression>
                                               <capture number="0" name="context.openparenthesis.level4"/>
                                           </starts-with>
                                           <ends-with>
                                               <expression>\)</expression>
                                               <capture number="0" name="context.closeparenthesis.level4"/>
                                           </ends-with>
                                           <subzones name="context.between.parentheses">
                                               <zone name="context.delimiter.balanced.parenthesis-level5">
                                                   <starts-with>
                                                       <expression>\(</expression>
                                                       <capture number="0" name="context.openparenthesis.level5"/>
                                                   </starts-with>
                                                   <ends-with>
                                                       <expression>\)</expression>
                                                       <capture number="0" name="context.closeparenthesis.level5"/>
                                                   </ends-with>
                                                   <subzones name="context.between.parentheses">
                                                       <zone name="context.delimiter.balanced.parenthesis-level6">
                                                           <starts-with>
                                                               <expression>\(</expression>
                                                               <capture number="0" name="context.openparenthesis.level6"/>
                                                           </starts-with>
                                                           <ends-with>
                                                               <expression>\)</expression>
                                                               <capture number="0" name="context.closeparenthesis.level6"/>
                                                           </ends-with>
                                                           <subzones name="context.between.parentheses">
                                                               <zone name="context.delimiter.balanced.parenthesis-level7">
                                                                   <starts-with>
                                                                       <expression>\(</expression>
                                                                       <capture number="0" name="context.openparenthesis.level7"/>
                                                                   </starts-with>
                                                                   <ends-with>
                                                                       <expression>\)</expression>
                                                                       <capture number="0" name="context.closeparenthesis.level7"/>
                                                                   </ends-with>
                                                                   <subzones name="context.between.parentheses">
                                                                       <zone name="context.delimiter.balanced.parenthesis-level8">
                                                                           <starts-with>
                                                                               <expression>\(</expression>
                                                                               <capture number="0" name="context.openparenthesis.level8"/>
                                                                           </starts-with>
                                                                           <ends-with>
                                                                               <expression>\)</expression>
                                                                               <capture number="0" name="context.closeparenthesis.level8"/>
                                                                           </ends-with>
                                                                           <subzones name="context.between.parentheses">
                                                                               <include collection="Between_Braces"/>
                                                                           </subzones>
                                                                       </zone>
                                                                       <include collection="Between_Braces"/>
                                                                   </subzones>
                                                               </zone>
                                                               <include collection="Between_Braces"/>
                                                           </subzones>
                                                       </zone>
                                                       <include collection="Between_Braces"/>
                                                   </subzones>
                                               </zone>
                                               <include collection="Between_Braces"/>
                                           </subzones>
                                       </zone>
                                       <include collection="Between_Braces"/>
                                   </subzones>
                               </zone>
                               <include collection="Between_Braces"/>
                           </subzones>
                       </zone>
                       <include collection="Between_Braces"/>
                   </subzones>
               </zone>
        </collection>
        
        <collection name="Between_Braces">
        	<include collection="Comment"/>
            <include collection="DefinedVariable"/>
            <include collection="Define"/>
            <include collection="Csname"/>
            <include collection="Lua"/>
            <include collection="Metafun"/>
            <include collection="Environments"/>
            <include collection="Group"/>
            <include collection="If_Else"/>
            <include collection="Keywords"/>
            <include collection="Default_Order_of_Zones"/>
        </collection>
        
        <collection name="Between_Brackets">
        	<include collection="Comment"/>
            <include collection="DefinedVariable"/>
            <include collection="Define"/>
            <include collection="Lua"/>
            <include collection="Metafun"/>
            <include collection="Keys"/>
            <include collection="Keywords"/>
            <include collection="Default_Order_of_Zones"/>
        </collection>
        
        <collection name="TableCells">
            <zone name="context.container.table.cell">
                <starts-with>
                    <expression>\\(?:b(TD|TC|TH))\b</expression>
                    <capture number="0" name="support.function.table.cell.begin"/>
                </starts-with>
                <ends-with>
                    <expression>\\(e(\1))\b</expression>
                    <capture number="0" name="support.function.table.cell.end"/>
                </ends-with>
                <subzones>
                    <include collection="Default_Order_of_Zones"/>
                </subzones>
            </zone>
        </collection>
        
         <collection name="TableRows">
         
            <zone name="context.support.function.table.row.end">
                <expression>\\(HL|TB|NR|SR|FR|MR|LR|AR)\b</expression>
            </zone>
            
            <zone name="context.support.function.table.cell.begin">
                <expression>\\(NC|VL|NC|VL)\b</expression>
            </zone>
            
            <zone name="context.container.table.row">
            <starts-with>
                    <expression>\\bTR\b</expression>
                    <capture number="0" name="support.function.table.row.begin"/>
            </starts-with>
            <ends-with>
                    <expression>\\eTR\b</expression>
                    <capture number="0" name="support.function.table.row.end"/>
            </ends-with>
                <subzones>
                    <include collection="TableCells"/>
                </subzones>
            </zone>
            
        </collection>
        
        <collection name="Comment">
            
            <zone name="context.comment-line-empty">
                <expression>(%)\s*$</expression>
                <capture number="1" name="context.punctuation.comment.begin"/>   
            </zone>    
            <zone name="context.comment.line">
                <expression>(%)(?:\s*(.+)$\n?)|(%)(?:\s*$\n?)</expression>
                <capture number="1" name="context.punctuation.comment.begin"/>   
            </zone>
            
        </collection>
        
        <collection name="Escapecharacter">
            <zone name="context.literal.escape.character">
                <expression>\\[^0-9a-zA-Z@?!\[\]\(\)]</expression>
            </zone>
        </collection>
        
        <collection name="EscapecharacterDollar">
            <zone name="context.literal.escape.character.dollar">
                <expression>\\\$</expression>
            </zone>
        </collection>
        
        <collection name="Csname">
            <zone name="context.container.support.function.csname">
                <starts-with>
                    <expression>\\csname\b</expression>
                    <capture number="0" name="context.support.function.general.csname"/>
                </starts-with>
                <ends-with>
                    <expression>\\endcsname\b</expression>
                    <capture number="0" name="context.support.function.general.csname"/>
                </ends-with>
                <subzones name="context.support.function.name.subzone">
                    <include collection="DefinedVariable"/>
                </subzones>
            </zone>
        </collection>
        
        <collection name="Define">
            
            <zone name="context.support.function.define">
            	<starts-with>
            		<expression>(\\(?:g|e|x)?def|\\define)\s*(?:(\[)(\d)(\]))?\s*(\\[A-Za-z@!?:_]*[A-Za-z@!?:_])\s*((?:\#{1,9}[A-Za-z_@!?:1-9]+)+)?\s*(\[)</expression>
            		<capture number="1" name="context.support.function.general.def"/>
            		<capture number="2" name="context.openbracket.level0"/>
            		<capture number="3" name="context.support.variable.define"/>
            		<capture number="4" name="context.closebracket.level0"/>
            		<capture number="5" name="context.support.function.name"/>
            		<capture number="6" name="context.support.variable.define"/>
            		<capture number="7" name="context.openbracket.level0"/>
            	</starts-with>
            	<ends-with>
            		<expression>\]</expression>
            		<capture number="0" name="context.closebracket.level0"/>
            	</ends-with>
            	<subzones name="context.support.function-name.subzone">
            	    <include collection="Between_Brackets"/>
            	</subzones>
            </zone> 	
            <zone name="context.support.function.define">
				<expression>(\\(?:g|e|x)?def|\\define)\s*(?:(\[)(\d)(\]))?\s*(\\[A-Za-z@!?:_]*[A-Za-z@!?:_])</expression>
				<capture number="1" name="context.support.function.general.def"/>
				<capture number="2" name="context.openbracket.level0"/>
				<capture number="3" name="context.support.variable.define"/>
				<capture number="4" name="context.closebracket.level0"/>
				<capture number="5" name="context.support.function.name"/>
            </zone>
            
            <zone name="context.support.function.new">
                <expression>\\new(?:if|conditional|every|counter|signal|box|count|dimen|fam|insert|language|muskip|read|skip|toks|write)\b\s*(\\[A-Za-z@!?:_]*[A-Za-z@!?:_])?</expression>
                <capture number="1" name="context.support.function.name"/>
            </zone>
            
            <zone name="context.support.function.let">
                <expression>\\(?:future)?let\b\s*(\\[A-Za-z@!?:_]*[A-Za-z@!?:_])?</expression>
                <capture number="1" name="context.support.function.name"/>
            </zone>
            
        </collection>
        
        <collection name="DefinedVariable">
            <zone name="context.support.variable.define">
                <expression>\#{1,9}[A-Za-z_@!?:1-9]+</expression>
            </zone>
        </collection>
        
        <collection name="Environments">

            <zone name="context.support.function.structural.float">
                    <expression>\\(place|complete)[0-9A-Za-z_@!?:]+</expression>
            </zone>
            
            <!--table-->
            <zone name="context.container.environment.table">
            	<starts-with>
            		<expression>(?:\\bTABLE(head|foot|body|next)?)\b</expression>
            		<capture number="0" name="context.support.function.start.table"/>
            	</starts-with>
            	<ends-with>
            		<expression>\\eTABLE\1</expression>
            		<capture number="0" name="context.support.function.stop.table"/>
            	</ends-with>
            	<subzones>
            		<include collection="Define"/>
            		<include collection="TableRows"/>
            		<include collection="Default_Order_of_Zones"/>
            	</subzones>
            </zone>
            <zone name="context.container.environment.table">
            	<starts-with>
            		<expression>(?:\\start(TABLE|table(head|tail)?|tabulate|linetable))\b</expression>
            		<capture number="0" name="context.support.function.start.table"/>
            	</starts-with>
            	<ends-with>
            		<expression>\\stop\1</expression>
            		<capture number="0" name="context.support.function.stop.table"/>
            	</ends-with>
            	<subzones>
            		<include collection="Define"/>
            		<include collection="TableRows"/>
            		<include collection="Default_Order_of_Zones"/>
            	</subzones>
            </zone>
            <!--protect/unprotect environment-->
            <zone name="context.container.unprotect-protect">
				<starts-with>
					<expression>\\unprotect\b</expression>
					<capture number="0" name="context.support.function.start.unprotect-protect"/>
				</starts-with>
				<ends-with>
					<expression>\\protect\b</expression>
						<capture number="0" name="context.support.function.stop.unprotect-protect"/>
				</ends-with>
				<subzones>
					<include collection="Define"/>
					<include collection="Default_Order_of_Zones"/>
				</subzones>
			</zone>

        </collection>
                
        <collection name="Lua">
        
            <zone name="context.container.injection.source.Lua">
                <starts-with>
                    <expression>(?:\\start((lua)(code|parameterset)|usercode))\b</expression>
                    <capture number="0" name="context.support.function.start.lua"/>
                </starts-with>
                <ends-with>
                    <expression>\\stop\1\b</expression>
                    <capture number="0" name="context.support.function.stop.lua"/>
                </ends-with>
                <subzones>
                	<include collection="Default_Order_of_Zones"/>
                </subzones>
            </zone>
            
            <zone name="context.container.injection.source.Lua">
                <starts-with>
                    <expression>((?:\\(?:ctx|direct|late)lua|\\ctxsprint|(?:luaescapestring))|\\ctxcommand|\\usercode)\s*(\{)</expression>
                    <capture number="1" name="context.support.function.general.lua"/>
                    <capture number="2" name="context.openbrace.level0"/>
                </starts-with>
                <ends-with>
                    <expression>\}</expression>
                    <capture number="0" name="context.closebrace.level0"/>
                </ends-with>
                <subzones>
                	<include collection="Default_Order_of_Zones"/>
                </subzones>
            </zone>
            
        </collection>
        
        <collection name="Metafun">
            <zone name="context.container.injection.source-MetaFun">
                <starts-with>
                    <expression>(\\start(unique|reusable|use|static)?MP)(code|inclusions|extensions|initializations|definitions|drawing|run|clip|(position)?graphic|environment|page|figure)\b</expression>
                    <capture number="0" name="context.support.function.start.metafun"/>
                </starts-with>
                <ends-with>
                    <expression>\\stop\2MP\3\b</expression>
                    <capture number="0" name="context.support.function.stop.metafun"/>
                </ends-with>
                <subzones>
                    <include collection="Default_Order_of_Zones"/>
                </subzones>
            </zone>
        </collection>
        
        <collection name="Document">
            <zone name="context.structural.container.document">
                <starts-with>
                    <expression>\\start(text|component)\b</expression>
                    <capture number="0" name="context.support.function.structural.document.start.text"/>
                </starts-with>
                <ends-with>
                    <expression>\\stop\1\b</expression>
                    <capture number="0" name="context.support.function.structural.document.stop.text"/>
                </ends-with>
                <subzones>
                    <include collection="Default_Order_of_Zones"/>
                </subzones>
            </zone>
        </collection>
        
        <collection name="Math">
			<zone name="context.math.textstyle">
				<starts-with>
					<expression>(\\(?:mathematics|inlinemath|math|inlinemathematics))\s*(\{)</expression>
					<capture number="0" name="context.begin.math"/>
				</starts-with>
			<ends-with>
				<expression>\}</expression>
				<capture number="0" name="context.end.math"/>
			</ends-with>
				<subzones>
					<include syntax="EscapecharacterDollar"/>
					<include syntax="text.TeX.math.ConTeXt"/>
					<include collection="Default_Order_of_Zones"/>
				</subzones>
			</zone>
			<zone name="context.math.displaystyle">
				<starts-with>
					<expression>(\\(?:displaymath|displaymathematics|automathematics))\s*(\{)</expression>
					<capture number="0" name="context.begin.math"/>
				</starts-with>
			<ends-with>
				<expression>\}</expression>
				<capture number="0" name="context.end.math"/>
			</ends-with>
				<subzones>
					<include syntax="EscapecharacterDollar"/>
					<include syntax="text.TeX.math.ConTeXt"/>
					<include collection="Default_Order_of_Zones"/>
				</subzones>
			</zone>
			<zone name="context.math.displaystyle">
				<starts-with>
					<expression>\\startformula</expression>
					<capture number="0" name="context.begin.math"/>
				</starts-with>
			<ends-with>
				<expression>\\stopformula</expression>
				<capture number="0" name="context.end.math"/>
			</ends-with>
				<subzones>
					<include syntax="EscapecharacterDollar"/>
					<include syntax="text.TeX.math.ConTeXt"/>
					<include collection="Default_Order_of_Zones"/>
				</subzones>
			</zone>
        	<zone name="context.math.textstyle">
        	    <starts-with>
        	        <expression>\$(?!\$)</expression>
        	        <capture number="0" name="context.begin.math"/>
        	    </starts-with>
        	    <ends-with>
        	        <expression>\$(?!\$)</expression>
        	        <capture number="0" name="context.end.math"/>
        	    </ends-with>
        	    <subzones>
        	        <include syntax="EscapecharacterDollar"/>
        	        <include syntax="text.TeX.math.ConTeXt"/>
        	        <include collection="Default_Order_of_Zones"/>
        	    </subzones>
        	</zone>
            <zone name="context.literal.string.math.displaystyle">
                <starts-with>
                    <expression>\$\$</expression>
                    <capture number="0" name="context.begin.math"/>
                </starts-with>
                <ends-with>
                    <expression>\$\$</expression>
                    <capture number="0" name="context.end.math"/>
                </ends-with>
                <subzones>
                    <include syntax="EscapecharacterDollar"/>
                    <include syntax="text.TeX.math.ConTeXt"/>
                    <include collection="Default_Order_of_Zones"/>
                </subzones>
            </zone>
        </collection>
        
        <collection name="Keys">
            <zone>
				<expression>(\\?[0-9A-Za-z_@!?:]+)\s*(=)</expression>
				<capture number="1" name="context.key-name"/>
				<capture number="2" name="keyword.operator.assignment"/>
            </zone>
        </collection>
        
        <collection name="Sectioning">
        
            <zone name="context.support.function.structural.document.section">
				<expression>(\\(?:part|title|chapter|SlideTitle)|\\(?:sub)*(?:section|subject))\b</expression>
            </zone>
            
            <zone>
                <starts-with>
                    <expression>\\start([0-9A-Za-z_@!?:]+)\b</expression>
                    <capture number="0" name="context.support.function.structural.document.start.section"/>
                </starts-with>
                <ends-with>
                    <expression>\\stop\1\b</expression>
                    <capture number="0" name="context.support.function.structural.document.stop.section"/>
                </ends-with>
                <subzones>
                    <include collection="Default_Order_of_Zones"/>
                </subzones>
            </zone>
            
        </collection>
        
        <collection name="GeneralTeX">
        	<zone name="context.support.function.general">
        	    <expression>\\[A-Za-z@!?:_]*[A-Za-z@!?:_]</expression>
        	</zone>
        	<zone name="context.punctuation.separator.comma">
        	    <expression>,</expression>
        	</zone>
        </collection>
        
        <collection name="Keywords">
        
        	<zone name="context.keyword.other.spacecodes">
        	    <expression>\\\.|\\!|\\,|\\:|\\;</expression>
        	</zone>
        	
        	<zone name="context.keyword.other.wordboundary">
        	    <expression>\\/|\|\||\\\s|\\-|\|-\||\|/\||~|\|&lt;\||\|&gt;\|</expression>
        	</zone>
            
            <zone name="context.keyword.other.misc">
                <expression>(?&lt;=sa)\s+\*|\b((sa|at|scaled|mo|mu)(?=\s*[\+\-#0-9\.\*\\])|(\d+)\s*(\*)\s*(small|medium|big|hang|line|halfline|formula)|(\\s!)?(spec:|name:|file:))\b</expression>
            </zone>
            
            <zone name="context.support.function.general.counting">
                <expression>\\(advance|divide|multiply)\b</expression>
            </zone>
            
            <zone name="context.support.function.general.box">
                <expression>\\\w*box\b</expression>
            </zone>
            
			<zone name="context.support.function.general.rule">
				<expression>\\\w*rule\b</expression>
			</zone>
			
			<zone name="context.support.function.general.kern">
				<expression>\\\w*kern(?![a-zA-Z])</expression>
			</zone>
            
            <zone name="context.keyword-zone.to-spread-keyword">
                <expression>(to|spread)\s*(?:((?:\+|\-)?[0-9]*(\.|,)?[0-9]+)\s*(fi(?:lll|ll|l)|(?:\s*(true)?\s*(mu|cm|mm|in|pt|bp|em|ex|pc|sp|cc|dd)))|((\\[A-Za-z@!?:_]*[A-Za-z@!?:_]\s*)+))</expression>
                <capture number="1" name="context.keyword.to-spread-keyword"/>
                <capture number="2" name="context.numeric"/>
                <capture number="3" name="context.keyword.number-separator"/>
                <capture number="4" name="context.keyword.other.fillls"/>
                <capture number="5" name="context.keyword.other.true"/>
                <capture number="6" name="context.keyword.unit"/>
                <capture number="7" name="context.support.function.general"/>
            </zone>
            
            <zone name="context.keyword-zone.skip-keyword">
                <expression>(\\[A-Za-z_@!?:]*(?&lt;!un)(?:skip|size)[A-Za-z_@!?:]*)\s*(?:((?:\+|\-)?[0-9]*(\.|,)?[0-9]+)\s*(fi(?:lll|ll|l)|(?:\s*(true)?\s*(mu|cm|mm|in|pt|bp|em|ex|pc|sp|cc|dd)))|((\\[A-Za-z@!?:_]*[A-Za-z@!?:_]\s*)+))</expression>
                <capture number="1" name="context.support.function.general"/>
                <capture number="2" name="context.numeric"/>
                <capture number="3" name="context.keyword.number-separator"/>
                <capture number="4" name="context.keyword.other.fillls"/>
                <capture number="5" name="context.keyword.other.true"/>
                <capture number="6" name="context.keyword.unit"/>
                <capture number="7" name="context.support.function.general"/>
            </zone>
            
            <zone name="context.keyword-zone.plus-minus-keyword">
                <expression>(minus|plus)</expression>
            </zone>
            
			<zone name="context.keyword-zone.depth-width-height-keyword">
				<expression>(depth|width|height)</expression>
			</zone>
            
            <zone name="context.keyword-zone.by-keyword">
                <expression>by</expression>
            </zone>
            
            <zone name="context.keyword-zone.unit">
                <expression>((?:\+|\-)?[0-9]*(\.|,)?[0-9]+)\s*(true)?\s*(mu|cm|mm|in|pt|bp|em|ex|pc|sp|cc|dd)</expression>
                <capture number="1" name="context.numeric"/>
                <capture number="2" name="context.keyword.number-separator"/>
                <capture number="3" name="context.keyword.other.true"/>
                <capture number="4" name="context.keyword.unit"/>
            </zone>
            
        </collection>
        
    </library>
    
</syntax>




